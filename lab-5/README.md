# A. Ёлки-палки 2.0
Несмотря на все ваши старания, новогодняя бинарная ёлка в ИТМО все равно упала. Недолго думая, руководство решило обратиться за помощью к уважаемым коллегам из нового физтеха. Проведя расчеты и эксперименты, физики предложили вам такое решение - сделать из обычного бинарного дерева бинарное дерево поиска и нарядить дерево так, чтобы никакие две ветки не отличались высотой более чем на 1.

Входные данные

В первой строчке дано $n (1≤n≤10^6)$ - количество вершин.

Во второй строчке дано $n$ чисел $(−10^9≤a_{i}≤10^9)$, разделенных пробелом, - количество украшений в вершине дерева, отсортированных по возрастанию. Также не существует двух таких вершин, количества украшений которых одинаковы.

Выходные данные

Вывести бинарное дерево через preorder обход. В случае нескольких возможных ответов нужно вывести тот, в котором корень каждого поддерева минимально возможный

# B. Предки - наше всё
Компания OOO "Предки $−$ наше все" занимается построением генеалогического древа. Так оказалось, что вместо стажировки в Яндексе вы решили пойти работать в эту компанию для того, чтобы оплатить свое образование. К несчастью, данные о предках ваших клиентов постоянно меняются, поэтому часто приходится его редактировать. Удивительным образом вы заметили, что генеалогического древа для текущего клиента является бинарным деревом, где в вершине значение является возрастом данного человека. Дабы автоматизировать процесс и ускорить процесс подготовки проекта, вы решили запрогать все редактирование и трассировку с помощью следующих комманд:  

$insert x −$ добавить нового человека с возрастом $x$ в древо. Если в дереве уже есть человек с возрастом $x$, то добавлять нового не надо.  

$delete x −$ удалить из дерева чевловека с возрастом $x$. Если человека с возрастом $x$ в древе нет, ничего делать не надо.  

$exists x −$ если есть человек с возрастом x есть в древе, вывести "true", если нет - "false".  

$next x −$ вывести минимальный возраст в древе, строго больший $x$, или "none", если такого нет.  

$prev x −$ вывести максимальный возраст в древе, строго меньший $x$, или "none", если такого нет.

В древо помещаются и извлекаются только целые числа, не превышающие по модулю $10^9$  
 

Входные данные  

Операций с древом, их количество не превышает $100$.

Выходные данные

Выведите последовательно результат выполнения всех операций exists, next, prev. Каждый ответ на новой строчке.

# C. И здесь К-ый максимум...
Бабушка Дуся вернулась с невероятного приключения к себе домой в деревню. За время её отдыха, яблоня в огороде выросла и стала плодоносить. Из-за своей привязанности и любви к дереву, она внимательно следила за каждым появившимся яблоком и научилась на глаз определять его вес. Своим талантом она известна на всю деревню, поэтому соседи, желая проверить её, просили назвать $k$-й максимум среди весов всех яблок, находящихся на дереве.

Входные данные

На первой строчке находится число $n (1≤n≤10^5)$ - количество команд

Далее на $n$ строчках идут команды трёх типов:  
$1 k$ - появляется новое яблоко c весом $k$  
$0 k$ - бабушку просят назвать $k$-й максимум  
$-1 k$ - яблоко с весом $k$ падает с дерева  
$∣k∣≤10^9$  
 

Выходные данные  

На каждую просьбу соседов вывести $k$-ый максимум.

# D. Ёлки-палки
На Новый год в ИТМО возле входа в вуз ставится большая красиво украшенная ёлка. Прошлый год не был исключением, но поскольку ИТМО $−$ первый неклассический вуз, то вместо обычной ёлки решили установить ёлку в виде бинарного дерева, где в каждой вершине свое количество украшений согласно свойствам бинарного дерева. К сожалению, со временем дерево накренилось вправо, из-за чего было принято решение снять самые правые украшения на каждом уровне.

Входные данные

Первая строчка $n (1≤n≤10^3)$ - количество вершин в дереве

Вторая строчка - $n$ чисел $(−10^9≤a_{i}≤10^9)$, задающие количество украшений в каждой вершине дерева построенного через последовательный insert.

Выходные данные

Вывести через пробел количество украшений самых правых вершин на каждом уровне, начиная с $1$

# E. Три друга
Три друга списывают лабораторную работу, каждый из них списывает по $n$ различных задач. Поскольку друзья не очень умные, они не меняют названия отправляемых на проверку файлов.

По истечении времени, отведенного на написание лабораторной, преподаватель запускает бан-машину и ставит баллы по следующим правилам:

* если задача написана только у одного студента, то этот студент получает 3 балла, поскольку эту задачу он не списывал и не давал списывать;
* если задача списана ровно у двух студентов, то каждый из них получает по 1 утешительному баллу;
* если задача списана всеми тремя студентами, то за нее баллы не начисляются никому.

Выведите финальное количество баллов у каждого студента.  

В рамках этой задачи будем считать, что Бан-машина считает решения списанными, если у них полностью совпадают имена файлов.  

Входные данные

В первой строке входных данных дается число $n (1≤n≤10000)$ - количество задач в лабораторной.

Следующие три строки содержат по $n$ различных слов в каждой — названия файлов с решениями, отправленных каждым из студентов.

Выходные данные

Необходимо вывести 3 числа - количество баллов у первого, второго и третьего студента соответственно.

# F. Подельник
Тяжело себе представить более несчастного человека, чем тот, кто планировал заботать предмет за ночь перед экзаменом и не преуспел в этом. Именно такая беда приключилась с незадачливым студентом Славой, поэтому он отлетел на допсу по алгоритмам. Во второй раз Слава решил не рисковать и попросил вас помочь ему закрыть этот ужасный предмет(готовиться заранее $−$ удел слабых).

Наступил день экзамена. Славе повезло, так как у экзаменатора в этот день было хорошее настроение. Преподаватель нарисовал перед ним бинарное дерево поиска и попросил написать порядок вывода вершин при каждом виде обхода этого дерева. Слава записал три строчки чисел и отправил их вам на проверку. Ваша задача $−$ написать программу, проверяющую корректность результатов Славы. Другими словами, может ли существовать дерево с таким порядком вершин при обходах. Помогите Славе, его жизнь в ваших руках!

Входные данные  

В первой строке записано число $n ≤ 10^7$ − количество вершин в дереве. В следующих 3 строках записаны по n чисел - результаты $pre−$, $in−$ и $post−order$ обхода дерева соответственно.  

Выходные данные  

В единственной строке выведите $YES$ при валидности обходов и $NO$ в обратном случае.  

# G. Всё, давай, я очень занятой.
Денис $−$ очень занятой человек. Поэтому он нанял Вас, чтобы оптимизировать свои жизненные процессы.

Самое важное для Дениса $−$ это саморазвитие, из-за чего для каждого дня он составляет расписание в виде бинарного дерева. Каждая вершина которого $−$ это польза от завершения некоторой работы в течение дня.

Чтобы получать максимальную пользу от каждой минуты своего драгоценного времени, Денис ищёт в своем расписании оптимальный участок для работы. Таковым он называет поддерево, которое является BST с максимальной пользой (сумма вершин в BST).

Входные данные

Ввод начинается с значения в корне дерева.  
$l −$ спуск в левого ребёнка  
$r −$ спуска в правого ребёнка  
$u −$ подъём наверх  

В единственной строке подается $n (n≤11∗10^6)$ значений.  

Выходные данные  

Вывести в единственной строке число $-$ максимальную пользу.  

# H. Доска задач
В крупной компании два разработчика — Николай и Степан работают над различными задачами. Каждый разработчик может взять и отказаться от задачи. Также Степан, ввиду своей нерасторопности, может делегировать все свои задачи Николаю. Для удобства взаимодействия с доской задач разработчикам были присвоены идентификаторы. Николай имеет идентификатор, равный 0, а Степан — равный 1.

Так, с доской могут производиться следующие операции:  
$0 ID task$ — разработчик с идентификатором $ID$ берет задачу с номером $task$.  

$1 ID task$ — разработчик с идентификатором $ID$ отказывается от задачи с номером $task$.  
$2$ — все задачи переходят Николаю.  

После каждой передачи задач нужно отчитываться перед менеджером, поэтому после этой операции требуется вывести номера задач в отсортированном виде без пробела на конце.

Входные данные

В первой строке подается $n (1≤n≤25000)$ — количество операций.

В следующих $n$ строках подаются команды одного из трех видов. Гарантируется, что номер задачи неотрицателен и не превышает $10^9$.

Выходные данные  

При каждой операции $2$ вывести номера задач Николая в отсортированном виде.